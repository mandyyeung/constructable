<% if @requests.count > 0 %>
  <div id="search" class="pull-right">
    <%= search_form_for @q, html: {class: "form-inline"} do |f| %>
    <%= hidden_field_tag :direction, params[:direction] %>
    <%= hidden_field_tag :sort, params[:sort] %>
    <%= f.search_field :subject_or_body_or_responses_body_cont, placeholder: "Search...", class: "form-control" %>
    <%= f.submit class:"btn btn-primary" %>
    <% end %>
  </div>
  <div class="table-responsive">
    <table class="table table-striped">
      <thead>
        <tr>
          <th><%= sortable "id", "#" %></th>
          <th class="sort"><%= sortable "subject", "Subject" %></th>
          <th class="sort"><%= sortable "user_id", "From" %></th>
          <th class="sort"><%= sortable "to", "To" %></th>
          <th class="sort"><%= sortable "due", "Due" %></th>
          <th class="sort"><%= sortable "responsed", "Responded" %></th>
          <th class="sort"><%= sortable "status", "Status" %></th>
          <% if current_user && current_user.admin? %>
            <th>Edit/Delete</th>
          <% end %>
        </tr>
      </thead>
      <tbody>
        <% @requests.each do |request| %>
        <tr>
          <th scope="row" class="rfiNum"><%= request.id %></th>
          <td><%= link_to request.subject, request_path(request) %></td>
          <td><%= request.user.full_name %></td>
          <td><%= request.to %></td>
          <td><%= request.due.strftime("%m/%d/%Y") %></td>
          <td>
            <% if !!request.responses.find_by(primary: true) %>
              <%= request.responses.find_by(primary: true).created_at.strftime("%m/%d/%Y") %>
            <% else %>
            <% end %>
          </td>
          <td><%= request.status %></td>
          <% if current_user && current_user.admin? %>
            <td><%= link_to "Edit", edit_request_path(request) %>/
              <%= link_to "Delete", request_path(request), method: :delete %>
            </td>
          <% end %>
        </tr>
        <% end %>
      </tbody>
    </table>
  </div>
  <%= will_paginate @requests, class: "pull-right" %>
<% else %>
  <h1>No RFIs available</h1>
<% end %>
